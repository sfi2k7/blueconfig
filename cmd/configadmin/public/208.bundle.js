/*! For license information please see 208.bundle.js.LICENSE.txt */
"use strict";(self.webpackChunksqdosadmin=self.webpackChunksqdosadmin||[]).push([[208],{8208:(e,t,n)=>{n.r(t),n.d(t,{default:()=>Y});var r=n(6540),a=n(1468);n(6059);const o=function(e){var t=e.sensors,n=e.selectedSensor,a=e.onSelectSensor;return r.createElement("div",{className:"sensor-list card"},r.createElement("div",{className:"card-header"},r.createElement("h6",{className:"mb-0"},r.createElement("i",{className:"fas fa-list me-2"}),"Sensors (",t.length,")")),r.createElement("div",{className:"list-group list-group-flush",style:{maxHeight:"600px",overflowY:"auto"}},t.map(function(e){return r.createElement("button",{key:e.name,className:"list-group-item list-group-item-action ".concat((null==n?void 0:n.name)===e.name?"active":""),onClick:function(){return a(e)}},r.createElement("div",{className:"d-flex justify-content-between align-items-start"},r.createElement("div",{className:"flex-grow-1"},r.createElement("div",{className:"fw-bold"},r.createElement("i",{className:"fas fa-".concat((t=e.__sensor_type,"gauge"===t?"tachometer-alt":"counter"===t?"sort-numeric-up":"chart-line")," me-2")}),e.name),r.createElement("div",{className:"small mt-1"},e.__sensor_type&&r.createElement("span",{className:"badge bg-secondary me-1"},e.__sensor_type),e.__retention&&r.createElement("span",{className:"badge bg-info me-1"},e.__retention),e.__unit&&r.createElement("span",{className:"text-muted"},e.__unit))),e.__event_count&&r.createElement("span",{className:"badge bg-primary rounded-pill"},e.__event_count)));var t})))};var c=n(4653),s=n(6691),l=n(9107),i=n(7984),u=n(3495),m=n(8687),f=n(7018),d=n(6279),p=n(6081);function v(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",a=n.toStringTag||"@@toStringTag";function o(n,r,a,o){var l=r&&r.prototype instanceof s?r:s,i=Object.create(l.prototype);return y(i,"_invoke",function(n,r,a){var o,s,l,i=0,u=a||[],m=!1,f={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(t,n){return o=t,s=0,l=e,f.n=n,c}};function d(n,r){for(s=n,l=r,t=0;!m&&i&&!a&&t<u.length;t++){var a,o=u[t],d=f.p,p=o[2];n>3?(a=p===r)&&(l=o[(s=o[4])?5:(s=3,3)],o[4]=o[5]=e):o[0]<=d&&((a=n<2&&d<o[1])?(s=0,f.v=r,f.n=o[1]):d<p&&(a=n<3||o[0]>r||r>p)&&(o[4]=n,o[5]=r,f.n=p,s=0))}if(a||n>1)return c;throw m=!0,r}return function(a,u,p){if(i>1)throw TypeError("Generator is already running");for(m&&1===u&&d(u,p),s=u,l=p;(t=s<2?e:l)||!m;){o||(s?s<3?(s>1&&(f.n=-1),d(s,l)):f.n=l:f.v=l);try{if(i=2,o){if(s||(a="next"),t=o[a]){if(!(t=t.call(o,l)))throw TypeError("iterator result is not an object");if(!t.done)return t;l=t.value,s<2&&(s=0)}else 1===s&&(t=o.return)&&t.call(o),s<2&&(l=TypeError("The iterator does not provide a '"+a+"' method"),s=1);o=e}else if((t=(m=f.n<0)?l:n.call(r,f))!==c)break}catch(t){o=e,s=1,l=t}finally{i=1}}return{value:t,done:m}}}(n,a,o),!0),i}var c={};function s(){}function l(){}function i(){}t=Object.getPrototypeOf;var u=[][r]?t(t([][r]())):(y(t={},r,function(){return this}),t),m=i.prototype=s.prototype=Object.create(u);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,i):(e.__proto__=i,y(e,a,"GeneratorFunction")),e.prototype=Object.create(m),e}return l.prototype=i,y(m,"constructor",i),y(i,"constructor",l),l.displayName="GeneratorFunction",y(i,a,"GeneratorFunction"),y(m),y(m,a,"Generator"),y(m,r,function(){return this}),y(m,"toString",function(){return"[object Generator]"}),(v=function(){return{w:o,m:f}})()}function y(e,t,n,r){var a=Object.defineProperty;try{a({},"",{})}catch(e){a=0}y=function(e,t,n,r){function o(t,n){y(e,t,function(e){return this._invoke(t,n,e)})}t?a?a(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(o("next",0),o("throw",1),o("return",2))},y(e,t,n,r)}function b(e,t,n,r,a,o,c){try{var s=e[o](c),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,a)}function h(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,c,s=[],l=!0,i=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);l=!0);}catch(e){i=!0,a=e}finally{try{if(!l&&null!=n.return&&(c=n.return(),Object(c)!==c))return}finally{if(i)throw a}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return g(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?g(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}const E=function(e){var t,n,a=e.sensor,o=e.timeRange,y=e.interval,g=h((0,r.useState)([]),2),E=g[0],N=g[1],w=h((0,r.useState)(!1),2),_=w[0],S=w[1],k=h((0,r.useState)(null),2),O=k[0],j=k[1];(0,r.useEffect)(function(){a&&a.name&&x()},[a,o,y]);var x=function(){var e,t=(e=v().m(function e(){var t,n,r,c,s,l;return v().w(function(e){for(;;)switch(e.p=e.n){case 0:return S(!0),j(null),e.p=1,e.n=2,p.A.get("/timeseries/sensors/".concat(a.name,"/data"),{params:{window_size:o,scale:y,window_type:"tumbling",output_type:"graph"}});case 2:(t=e.v).data.success?(n=t.data.data.result,r=n.Points||[],console.log("Loaded ".concat(r.length," data points for ").concat(a.name)),c=r.map(function(e){return{timestamp:(t=e.Timestamp,n=new Date(1e3*t),r=y.match(/^(\d+)([smh])$/),a=r?parseInt(r[1])*({s:1,m:60,h:3600}[r[2]]||60):60,a<60?n.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",second:"2-digit"}):a<3600?n.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):n.toLocaleDateString([],{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})),rawTimestamp:e.Timestamp,value:e.Count>0&&void 0!==e.Avg?parseFloat(e.Avg.toFixed(2)):null,min:e.Count>0&&void 0!==e.Min?parseFloat(e.Min.toFixed(2)):null,max:e.Count>0&&void 0!==e.Max?parseFloat(e.Max.toFixed(2)):null,count:e.Count||0};var t,n,r,a}),N(c)):j(t.data.error||"Failed to load chart data"),e.n=4;break;case 3:e.p=3,l=e.v,console.error("Failed to load chart data:",l),j((null===(s=l.response)||void 0===s||null===(s=s.data)||void 0===s?void 0:s.error)||l.message),N([]);case 4:return e.p=4,S(!1),e.f(4);case 5:return e.a(2)}},e,null,[[1,3,4,5]])}),function(){var t=this,n=arguments;return new Promise(function(r,a){var o=e.apply(t,n);function c(e){b(o,r,a,c,s,"next",e)}function s(e){b(o,r,a,c,s,"throw",e)}c(void 0)})});return function(){return t.apply(this,arguments)}}();return _?r.createElement("div",{className:"sensor-chart card mb-3"},r.createElement("div",{className:"card-body text-center py-5"},r.createElement("div",{className:"spinner-border text-primary",role:"status"},r.createElement("span",{className:"visually-hidden"},"Loading...")),r.createElement("p",{className:"mt-2"},"Loading chart data..."))):O?r.createElement("div",{className:"sensor-chart card mb-3"},r.createElement("div",{className:"card-body"},r.createElement("div",{className:"alert alert-danger mb-0"},r.createElement("i",{className:"fas fa-exclamation-triangle me-2"}),"Failed to load chart: ",O))):0===E.length?r.createElement("div",{className:"sensor-chart card mb-3"},r.createElement("div",{className:"card-header"},r.createElement("h6",{className:"mb-0"},r.createElement("i",{className:"fas fa-chart-line me-2"}),a.name,(a.unit||a.__unit)&&r.createElement("span",{className:"text-muted ms-2"},"(",a.unit||a.__unit,")"))),r.createElement("div",{className:"card-body"},r.createElement("div",{className:"alert alert-info mb-0"},r.createElement("i",{className:"fas fa-info-circle me-2"}),"No event data available in the selected time range (",o,"). Try a larger time window or post events to this sensor."))):r.createElement("div",{className:"sensor-chart card mb-3"},r.createElement("div",{className:"card-header"},r.createElement("h6",{className:"mb-0"},r.createElement("i",{className:"fas fa-chart-line me-2"}),a.name,(a.unit||a.__unit)&&r.createElement("span",{className:"text-muted ms-2"},"(",a.unit||a.__unit,")"),r.createElement("span",{className:"text-muted ms-2 small"},"(",E.filter(function(e){return e.count>0}).length,"/",E.length," ","buckets with data • ",o," range • ",y," interval)"))),r.createElement("div",{className:"card-body"},r.createElement(c.u,{width:"100%",height:300},r.createElement(s.b,{data:E,margin:{top:5,right:30,left:20,bottom:60}},r.createElement(l.d,{strokeDasharray:"3 3"}),r.createElement(i.W,{dataKey:"timestamp",tick:{fontSize:11},angle:-45,textAnchor:"end",height:80,interval:"preserveStartEnd"}),r.createElement(u.h,{tick:{fontSize:12}}),r.createElement(m.m,{contentStyle:{backgroundColor:"#fff",border:"1px solid #ccc"},formatter:function(e,t){return"Value"===t?[e,"Avg"]:[e,t]}}),r.createElement(f.s,null),r.createElement(d.N,{type:"monotone",dataKey:"value",stroke:"#0d6efd",strokeWidth:2,name:"Value",dot:{r:3},activeDot:{r:5},connectNulls:!0}),void 0!==(null===(t=E[0])||void 0===t?void 0:t.min)&&r.createElement(d.N,{type:"monotone",dataKey:"min",stroke:"#198754",strokeWidth:1,strokeDasharray:"3 3",name:"Min",dot:!1,connectNulls:!0}),void 0!==(null===(n=E[0])||void 0===n?void 0:n.max)&&r.createElement(d.N,{type:"monotone",dataKey:"max",stroke:"#dc3545",strokeWidth:1,strokeDasharray:"3 3",name:"Max",dot:!1,connectNulls:!0})))))},N=function(e){var t=e.timeRange,n=e.interval,a=e.onTimeRangeChange,o=e.onIntervalChange,c=e.onRefresh,s=e.onCreateSensor;return r.createElement("div",{className:"sensor-controls card mb-3"},r.createElement("div",{className:"card-body"},r.createElement("div",{className:"row align-items-end"},r.createElement("div",{className:"col-md-3"},r.createElement("label",{className:"form-label small"},"Time Range"),r.createElement("select",{className:"form-select form-select-sm",value:t,onChange:function(e){return a(e.target.value)}},r.createElement("option",{value:"5m"},"Last 5 minutes"),r.createElement("option",{value:"15m"},"Last 15 minutes"),r.createElement("option",{value:"1h"},"Last 1 hour"),r.createElement("option",{value:"6h"},"Last 6 hours"),r.createElement("option",{value:"12h"},"Last 12 hours"),r.createElement("option",{value:"24h"},"Last 24 hours"))),r.createElement("div",{className:"col-md-3"},r.createElement("label",{className:"form-label small"},"Interval"),r.createElement("select",{className:"form-select form-select-sm",value:n,onChange:function(e){return o(e.target.value)}},r.createElement("option",{value:"10s"},"10 seconds"),r.createElement("option",{value:"30s"},"30 seconds"),r.createElement("option",{value:"1m"},"1 minute"),r.createElement("option",{value:"5m"},"5 minutes"),r.createElement("option",{value:"15m"},"15 minutes"),r.createElement("option",{value:"1h"},"1 hour"))),r.createElement("div",{className:"col-md-6 text-end"},r.createElement("button",{className:"btn btn-primary btn-sm me-2",onClick:c},r.createElement("i",{className:"fas fa-sync me-1"}),"Refresh"),r.createElement("button",{className:"btn btn-success btn-sm",onClick:s},r.createElement("i",{className:"fas fa-plus me-1"}),"Create Sensor")))))};function w(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",a=n.toStringTag||"@@toStringTag";function o(n,r,a,o){var l=r&&r.prototype instanceof s?r:s,i=Object.create(l.prototype);return _(i,"_invoke",function(n,r,a){var o,s,l,i=0,u=a||[],m=!1,f={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(t,n){return o=t,s=0,l=e,f.n=n,c}};function d(n,r){for(s=n,l=r,t=0;!m&&i&&!a&&t<u.length;t++){var a,o=u[t],d=f.p,p=o[2];n>3?(a=p===r)&&(l=o[(s=o[4])?5:(s=3,3)],o[4]=o[5]=e):o[0]<=d&&((a=n<2&&d<o[1])?(s=0,f.v=r,f.n=o[1]):d<p&&(a=n<3||o[0]>r||r>p)&&(o[4]=n,o[5]=r,f.n=p,s=0))}if(a||n>1)return c;throw m=!0,r}return function(a,u,p){if(i>1)throw TypeError("Generator is already running");for(m&&1===u&&d(u,p),s=u,l=p;(t=s<2?e:l)||!m;){o||(s?s<3?(s>1&&(f.n=-1),d(s,l)):f.n=l:f.v=l);try{if(i=2,o){if(s||(a="next"),t=o[a]){if(!(t=t.call(o,l)))throw TypeError("iterator result is not an object");if(!t.done)return t;l=t.value,s<2&&(s=0)}else 1===s&&(t=o.return)&&t.call(o),s<2&&(l=TypeError("The iterator does not provide a '"+a+"' method"),s=1);o=e}else if((t=(m=f.n<0)?l:n.call(r,f))!==c)break}catch(t){o=e,s=1,l=t}finally{i=1}}return{value:t,done:m}}}(n,a,o),!0),i}var c={};function s(){}function l(){}function i(){}t=Object.getPrototypeOf;var u=[][r]?t(t([][r]())):(_(t={},r,function(){return this}),t),m=i.prototype=s.prototype=Object.create(u);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,i):(e.__proto__=i,_(e,a,"GeneratorFunction")),e.prototype=Object.create(m),e}return l.prototype=i,_(m,"constructor",i),_(i,"constructor",l),l.displayName="GeneratorFunction",_(i,a,"GeneratorFunction"),_(m),_(m,a,"Generator"),_(m,r,function(){return this}),_(m,"toString",function(){return"[object Generator]"}),(w=function(){return{w:o,m:f}})()}function _(e,t,n,r){var a=Object.defineProperty;try{a({},"",{})}catch(e){a=0}_=function(e,t,n,r){function o(t,n){_(e,t,function(e){return this._invoke(t,n,e)})}t?a?a(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(o("next",0),o("throw",1),o("return",2))},_(e,t,n,r)}function S(e,t,n,r,a,o,c){try{var s=e[o](c),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,a)}function k(e){return function(){var t=this,n=arguments;return new Promise(function(r,a){var o=e.apply(t,n);function c(e){S(o,r,a,c,s,"next",e)}function s(e){S(o,r,a,c,s,"throw",e)}c(void 0)})}}function O(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,c,s=[],l=!0,i=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);l=!0);}catch(e){i=!0,a=e}finally{try{if(!l&&null!=n.return&&(c=n.return(),Object(c)!==c))return}finally{if(i)throw a}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return j(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?j(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function j(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}const x=function(e){var t=e.sensor,n=e.limit,a=void 0===n?10:n,o=O((0,r.useState)([]),2),c=o[0],s=o[1],l=O((0,r.useState)(!1),2),i=l[0],u=l[1],m=O((0,r.useState)(null),2),f=m[0],d=m[1];(0,r.useEffect)(function(){if(t){v();var e=setInterval(v,5e3);return function(){return clearInterval(e)}}},[t]);var v=function(){var e=k(w().m(function e(){var n,r,o,c,l,i,m,f;return w().w(function(e){for(;;)switch(e.p=e.n){case 0:if(t){e.n=1;break}return e.a(2);case 1:if(u(!0),d(null),e.p=2,!t.path){e.n=6;break}return e.n=3,p.A.get("/node/".concat(t.path));case 3:if(!(n=e.v).data.success){e.n=5;break}return r=n.data.data.children||[],o=r.slice(0,2*a).map(function(){var e=k(w().m(function e(n){var r,a,o;return w().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,r="".concat(t.path,"/").concat(n),e.n=1,p.A.get("/properties/".concat(r));case 1:if(!(a=e.v).data.success){e.n=2;break}return o=a.data.data.properties||{},e.a(2,{ts:o.timestamp||o.ts||Date.now()/1e3,value:o.value||o.val||0,name:n});case 2:e.n=4;break;case 3:return e.p=3,e.v,e.a(2,null);case 4:return e.a(2)}},e,null,[[0,3]])}));return function(t){return e.apply(this,arguments)}}()),e.n=4,Promise.all(o);case 4:c=e.v.filter(function(e){return null!==e}).sort(function(e,t){return t.ts-e.ts}).slice(0,a),s(c);case 5:e.n=8;break;case 6:return e.n=7,p.A.get("/timeseries/sensors/".concat(t.name,"/events"));case 7:(l=e.v).data.success&&(i=l.data.result||[],m=i.sort(function(e,t){return t.ts-e.ts}).slice(0,a),s(m));case 8:e.n=10;break;case 9:e.p=9,f=e.v,console.warn("No events available:",f),s([]);case 10:return e.p=10,u(!1),e.f(10);case 11:return e.a(2)}},e,null,[[2,9,10,11]])}));return function(){return e.apply(this,arguments)}}();return r.createElement("div",{className:"event-log card mb-3"},r.createElement("div",{className:"card-header d-flex justify-content-between align-items-center"},r.createElement("h6",{className:"mb-0"},r.createElement("i",{className:"fas fa-stream me-2"}),"Recent Events"),i&&r.createElement("div",{className:"spinner-border spinner-border-sm text-primary",role:"status"},r.createElement("span",{className:"visually-hidden"},"Loading..."))),r.createElement("div",{className:"card-body p-0"},f&&r.createElement("div",{className:"alert alert-danger m-2 mb-0"},r.createElement("i",{className:"fas fa-exclamation-triangle me-2"}),f),0!==c.length||i?r.createElement("div",{className:"table-responsive",style:{maxHeight:"300px",overflowY:"auto"}},r.createElement("table",{className:"table table-sm table-hover mb-0"},r.createElement("thead",{className:"table-light sticky-top"},r.createElement("tr",null,r.createElement("th",null,"Time"),r.createElement("th",{className:"text-end"},"Value"))),r.createElement("tbody",null,c.map(function(e,n){return r.createElement("tr",{key:n},r.createElement("td",{className:"small"},(a=e.ts,new Date(1e3*a).toLocaleString())),r.createElement("td",{className:"text-end"},r.createElement("strong",null,e.value),(t.unit||t.__unit)&&r.createElement("span",{className:"text-muted ms-1"},t.unit||t.__unit)));var a})))):r.createElement("div",{className:"text-center text-muted py-3"},r.createElement("i",{className:"fas fa-inbox me-2"}),"No events yet. Post events to see them here.")))};function A(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",a=n.toStringTag||"@@toStringTag";function o(n,r,a,o){var l=r&&r.prototype instanceof s?r:s,i=Object.create(l.prototype);return T(i,"_invoke",function(n,r,a){var o,s,l,i=0,u=a||[],m=!1,f={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(t,n){return o=t,s=0,l=e,f.n=n,c}};function d(n,r){for(s=n,l=r,t=0;!m&&i&&!a&&t<u.length;t++){var a,o=u[t],d=f.p,p=o[2];n>3?(a=p===r)&&(l=o[(s=o[4])?5:(s=3,3)],o[4]=o[5]=e):o[0]<=d&&((a=n<2&&d<o[1])?(s=0,f.v=r,f.n=o[1]):d<p&&(a=n<3||o[0]>r||r>p)&&(o[4]=n,o[5]=r,f.n=p,s=0))}if(a||n>1)return c;throw m=!0,r}return function(a,u,p){if(i>1)throw TypeError("Generator is already running");for(m&&1===u&&d(u,p),s=u,l=p;(t=s<2?e:l)||!m;){o||(s?s<3?(s>1&&(f.n=-1),d(s,l)):f.n=l:f.v=l);try{if(i=2,o){if(s||(a="next"),t=o[a]){if(!(t=t.call(o,l)))throw TypeError("iterator result is not an object");if(!t.done)return t;l=t.value,s<2&&(s=0)}else 1===s&&(t=o.return)&&t.call(o),s<2&&(l=TypeError("The iterator does not provide a '"+a+"' method"),s=1);o=e}else if((t=(m=f.n<0)?l:n.call(r,f))!==c)break}catch(t){o=e,s=1,l=t}finally{i=1}}return{value:t,done:m}}}(n,a,o),!0),i}var c={};function s(){}function l(){}function i(){}t=Object.getPrototypeOf;var u=[][r]?t(t([][r]())):(T(t={},r,function(){return this}),t),m=i.prototype=s.prototype=Object.create(u);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,i):(e.__proto__=i,T(e,a,"GeneratorFunction")),e.prototype=Object.create(m),e}return l.prototype=i,T(m,"constructor",i),T(i,"constructor",l),l.displayName="GeneratorFunction",T(i,a,"GeneratorFunction"),T(m),T(m,a,"Generator"),T(m,r,function(){return this}),T(m,"toString",function(){return"[object Generator]"}),(A=function(){return{w:o,m:f}})()}function T(e,t,n,r){var a=Object.defineProperty;try{a({},"",{})}catch(e){a=0}T=function(e,t,n,r){function o(t,n){T(e,t,function(e){return this._invoke(t,n,e)})}t?a?a(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(o("next",0),o("throw",1),o("return",2))},T(e,t,n,r)}function P(e,t,n,r,a,o,c){try{var s=e[o](c),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,a)}function F(e){return function(){var t=this,n=arguments;return new Promise(function(r,a){var o=e.apply(t,n);function c(e){P(o,r,a,c,s,"next",e)}function s(e){P(o,r,a,c,s,"throw",e)}c(void 0)})}}function C(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,c,s=[],l=!0,i=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);l=!0);}catch(e){i=!0,a=e}finally{try{if(!l&&null!=n.return&&(c=n.return(),Object(c)!==c))return}finally{if(i)throw a}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return G(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?G(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function G(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}const D=function(e){var t=e.sensor,n=e.onSensorDeleted,a=e.onRefresh,o=C((0,r.useState)(!1),2),c=o[0],s=o[1],l=C((0,r.useState)(!1),2),i=l[0],u=l[1],m=function(){var e=F(A().m(function e(){var r;return A().w(function(e){for(;;)switch(e.p=e.n){case 0:if(window.confirm('Are you sure you want to delete sensor "'.concat(t.name,'"?\n\nThis will permanently delete all associated events.'))){e.n=1;break}return e.a(2);case 1:if(s(!0),e.p=2,!t.path){e.n=4;break}return e.n=3,p.A.delete("/node/".concat(t.path));case 3:alert('Sensor "'.concat(t.name,'" deleted successfully')),e.n=6;break;case 4:return e.n=5,p.A.delete("/timeseries/sensors/".concat(t.name));case 5:e.v.data.success&&alert('Sensor "'.concat(t.name,'" deleted successfully'));case 6:n&&n(),e.n=8;break;case 7:e.p=7,r=e.v,alert("Failed to delete sensor: ".concat(r.message)),console.error("Delete sensor failed:",r);case 8:return e.p=8,s(!1),e.f(8);case 9:return e.a(2)}},e,null,[[2,7,8,9]])}));return function(){return e.apply(this,arguments)}}(),f=function(){var e=F(A().m(function e(){var n,r,o,c,s;return A().w(function(e){for(;;)switch(e.p=e.n){case 0:if(n=t.retention||t.__retention||"24h",window.confirm('Clean up old events for sensor "'.concat(t.name,'"?\n\nThis will delete events older than the retention period (').concat(n,")."))){e.n=1;break}return e.a(2);case 1:if(u(!0),e.p=2,!t.path){e.n=3;break}alert("Cleanup is not yet implemented for node-based sensors. You can manually delete event nodes if needed."),e.n=5;break;case 3:return e.n=4,p.A.post("/timeseries/sensors/".concat(t.name,"/cleanup"));case 4:(r=e.v).data.success&&(c=(null===(o=r.data.result)||void 0===o?void 0:o.deleted)||0,alert("Successfully deleted ".concat(c," old event(s)")));case 5:a&&a(),e.n=7;break;case 6:e.p=6,s=e.v,alert("Failed to cleanup events: ".concat(s.message)),console.error("Cleanup failed:",s);case 7:return e.p=7,u(!1),e.f(7);case 8:return e.a(2)}},e,null,[[2,6,7,8]])}));return function(){return e.apply(this,arguments)}}(),d=function(e){return e?new Date(1e3*parseInt(e)).toLocaleString():"N/A"},v=t.type||t.__sensorType||t.__sensor_type||"N/A",y=t.unit||t.__unit||"N/A",b=t.retention||t.__retention||"N/A",h=t.event_count||t.__event_count||"0",g=t.created||t.__created,E=t.lastupdated||t.__lastupdated;return r.createElement("div",{className:"sensor-detail card mb-3"},r.createElement("div",{className:"card-header"},r.createElement("h6",{className:"mb-0"},r.createElement("i",{className:"fas fa-info-circle me-2"}),"Sensor Details")),r.createElement("div",{className:"card-body"},r.createElement("dl",{className:"row mb-0"},r.createElement("dt",{className:"col-sm-5"},"Name:"),r.createElement("dd",{className:"col-sm-7"},t.name),r.createElement("dt",{className:"col-sm-5"},"Type:"),r.createElement("dd",{className:"col-sm-7"},r.createElement("span",{className:"badge ".concat("gauge"===v?"bg-info":"bg-primary")},v)),r.createElement("dt",{className:"col-sm-5"},"Unit:"),r.createElement("dd",{className:"col-sm-7"},y),r.createElement("dt",{className:"col-sm-5"},"Retention:"),r.createElement("dd",{className:"col-sm-7"},b),t.path&&r.createElement(r.Fragment,null,r.createElement("dt",{className:"col-sm-5"},"Path:"),r.createElement("dd",{className:"col-sm-7"},r.createElement("small",{className:"text-muted font-monospace"},t.path))),r.createElement("dt",{className:"col-sm-5"},"Event Count:"),r.createElement("dd",{className:"col-sm-7"},r.createElement("span",{className:"badge bg-secondary"},h)),g&&r.createElement(r.Fragment,null,r.createElement("dt",{className:"col-sm-5"},"Created:"),r.createElement("dd",{className:"col-sm-7"},r.createElement("small",{className:"text-muted"},d(g)))),E&&r.createElement(r.Fragment,null,r.createElement("dt",{className:"col-sm-5"},"Last Updated:"),r.createElement("dd",{className:"col-sm-7"},r.createElement("small",{className:"text-muted"},d(E))))),r.createElement("hr",null),r.createElement("div",{className:"d-grid gap-2"},r.createElement("button",{className:"btn btn-warning btn-sm",onClick:f,disabled:i||c},i?r.createElement(r.Fragment,null,r.createElement("span",{className:"spinner-border spinner-border-sm me-2",role:"status"}),"Cleaning..."):r.createElement(r.Fragment,null,r.createElement("i",{className:"fas fa-broom me-2"}),"Cleanup Old Events")),r.createElement("button",{className:"btn btn-danger btn-sm",onClick:m,disabled:c||i},c?r.createElement(r.Fragment,null,r.createElement("span",{className:"spinner-border spinner-border-sm me-2",role:"status"}),"Deleting..."):r.createElement(r.Fragment,null,r.createElement("i",{className:"fas fa-trash me-2"}),"Delete Sensor")))))};function I(e){return I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},I(e)}function L(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",a=n.toStringTag||"@@toStringTag";function o(n,r,a,o){var l=r&&r.prototype instanceof s?r:s,i=Object.create(l.prototype);return R(i,"_invoke",function(n,r,a){var o,s,l,i=0,u=a||[],m=!1,f={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(t,n){return o=t,s=0,l=e,f.n=n,c}};function d(n,r){for(s=n,l=r,t=0;!m&&i&&!a&&t<u.length;t++){var a,o=u[t],d=f.p,p=o[2];n>3?(a=p===r)&&(l=o[(s=o[4])?5:(s=3,3)],o[4]=o[5]=e):o[0]<=d&&((a=n<2&&d<o[1])?(s=0,f.v=r,f.n=o[1]):d<p&&(a=n<3||o[0]>r||r>p)&&(o[4]=n,o[5]=r,f.n=p,s=0))}if(a||n>1)return c;throw m=!0,r}return function(a,u,p){if(i>1)throw TypeError("Generator is already running");for(m&&1===u&&d(u,p),s=u,l=p;(t=s<2?e:l)||!m;){o||(s?s<3?(s>1&&(f.n=-1),d(s,l)):f.n=l:f.v=l);try{if(i=2,o){if(s||(a="next"),t=o[a]){if(!(t=t.call(o,l)))throw TypeError("iterator result is not an object");if(!t.done)return t;l=t.value,s<2&&(s=0)}else 1===s&&(t=o.return)&&t.call(o),s<2&&(l=TypeError("The iterator does not provide a '"+a+"' method"),s=1);o=e}else if((t=(m=f.n<0)?l:n.call(r,f))!==c)break}catch(t){o=e,s=1,l=t}finally{i=1}}return{value:t,done:m}}}(n,a,o),!0),i}var c={};function s(){}function l(){}function i(){}t=Object.getPrototypeOf;var u=[][r]?t(t([][r]())):(R(t={},r,function(){return this}),t),m=i.prototype=s.prototype=Object.create(u);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,i):(e.__proto__=i,R(e,a,"GeneratorFunction")),e.prototype=Object.create(m),e}return l.prototype=i,R(m,"constructor",i),R(i,"constructor",l),l.displayName="GeneratorFunction",R(i,a,"GeneratorFunction"),R(m),R(m,a,"Generator"),R(m,r,function(){return this}),R(m,"toString",function(){return"[object Generator]"}),(L=function(){return{w:o,m:f}})()}function R(e,t,n,r){var a=Object.defineProperty;try{a({},"",{})}catch(e){a=0}R=function(e,t,n,r){function o(t,n){R(e,t,function(e){return this._invoke(t,n,e)})}t?a?a(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(o("next",0),o("throw",1),o("return",2))},R(e,t,n,r)}function M(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function U(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?M(Object(n),!0).forEach(function(t){$(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):M(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function $(e,t,n){return(t=function(e){var t=function(e){if("object"!=I(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=I(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==I(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function K(e,t,n,r,a,o,c){try{var s=e[o](c),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,a)}function W(e){return function(){var t=this,n=arguments;return new Promise(function(r,a){var o=e.apply(t,n);function c(e){K(o,r,a,c,s,"next",e)}function s(e){K(o,r,a,c,s,"throw",e)}c(void 0)})}}function z(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,c,s=[],l=!0,i=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);l=!0);}catch(e){i=!0,a=e}finally{try{if(!l&&null!=n.return&&(c=n.return(),Object(c)!==c))return}finally{if(i)throw a}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return V(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?V(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function V(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}const Y=function(e){var t=e.currentPath,n=(e.properties,(0,a.wA)(),z((0,r.useState)([]),2)),c=n[0],s=n[1],l=z((0,r.useState)(null),2),i=l[0],u=l[1],m=z((0,r.useState)("1h"),2),f=m[0],d=m[1],v=z((0,r.useState)("1m"),2),y=v[0],b=v[1],h=z((0,r.useState)(!1),2),g=h[0],w=h[1],_=z((0,r.useState)(null),2),S=_[0],k=_[1],O=z((0,r.useState)(!1),2);O[0],O[1],(0,r.useEffect)(function(){j()},[t]);var j=function(){var e=W(L().m(function e(){var n,r,a,o,c,l,m,f,d,v,y,b;return L().w(function(e){for(;;)switch(e.p=e.n){case 0:return w(!0),k(null),e.p=1,e.n=2,p.A.get("/node/".concat(t));case 2:if(!(n=e.v).data.success){e.n=9;break}if(r=n.data.data.children||[],a=r.includes("Sensors"),o=[],!a){e.n=6;break}return c="".concat(t,"/Sensors"),e.n=3,p.A.get("/node/".concat(c));case 3:if(!(l=e.v).data.success){e.n=5;break}return m=l.data.data.children||[],f=m.map(function(){var e=W(L().m(function e(t){var n,r,a,o;return L().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,n="".concat(c,"/").concat(t),e.n=1,p.A.get("/properties/".concat(n));case 1:if(!(r=e.v).data.success){e.n=2;break}return a=r.data.data.properties||{},e.a(2,U({name:t,path:n,type:a.__sensorType||a.type||"gauge",unit:a.__unit||a.unit||"",retention:a.__retention||a.retention||"24h",description:a.__description||a.description||""},a));case 2:e.n=4;break;case 3:return e.p=3,o=e.v,console.warn("Failed to load info for ".concat(t,":"),o),e.a(2,{name:t,path:"".concat(c,"/").concat(t),type:"gauge"});case 4:return e.a(2)}},e,null,[[0,3]])}));return function(t){return e.apply(this,arguments)}}()),e.n=4,Promise.all(f);case 4:o=e.v;case 5:e.n=8;break;case 6:return d=r.map(function(){var e=W(L().m(function e(n){var r,a,o,c;return L().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,r="".concat(t,"/").concat(n),e.n=1,p.A.get("/properties/".concat(r));case 1:if(!(a=e.v).data.success){e.n=2;break}if(!((o=a.data.data.properties||{}).__sensorType||o.type||o.__unit||o.unit)){e.n=2;break}return e.a(2,U({name:n,path:r,type:o.__sensorType||o.type||"gauge",unit:o.__unit||o.unit||"",retention:o.__retention||o.retention||"24h",description:o.__description||o.description||""},o));case 2:return e.a(2,null);case 3:return e.p=3,c=e.v,console.warn("Failed to load info for ".concat(n,":"),c),e.a(2,null)}},e,null,[[0,3]])}));return function(t){return e.apply(this,arguments)}}()),e.n=7,Promise.all(d);case 7:v=e.v,o=v.filter(function(e){return null!==e});case 8:s(o),!i&&o.length>0?u(o[0]):i&&(y=o.find(function(e){return e.name===i.name}),u(y||o[0]||null));case 9:e.n=11;break;case 10:e.p=10,b=e.v,k(b.message),console.error("Failed to load sensors:",b);case 11:return e.p=11,w(!1),e.f(11);case 12:return e.a(2)}},e,null,[[1,10,11,12]])}));return function(){return e.apply(this,arguments)}}(),A=function(){var e=W(L().m(function e(){var n,r,a,o,c,s,l;return L().w(function(e){for(;;)switch(e.p=e.n){case 0:if(n=prompt("Enter sensor name:")){e.n=1;break}return e.a(2);case 1:return r=prompt("Enter sensor type (gauge/counter):","gauge"),a=prompt("Enter unit (optional):")||"",o=prompt("Enter retention period (e.g., 24h, 7d):","24h"),e.p=2,w(!0),c="".concat(t,"/Sensors"),e.p=3,e.n=4,p.A.post("/node/".concat(c));case 4:e.n=6;break;case 5:e.p=5,e.v;case 6:return s="".concat(c,"/").concat(n),e.n=7,p.A.post("/node/".concat(s));case 7:return e.n=8,p.A.post("/properties/".concat(s),{key:"__sensorType",value:r});case 8:if(!a){e.n=9;break}return e.n=9,p.A.post("/properties/".concat(s),{key:"__unit",value:a});case 9:if(!o){e.n=10;break}return e.n=10,p.A.post("/properties/".concat(s),{key:"__retention",value:o});case 10:return e.n=11,p.A.post("/properties/".concat(s),{key:"__type",value:"sensor"});case 11:return e.n=12,j();case 12:alert("Sensor created successfully!"),e.n=14;break;case 13:e.p=13,l=e.v,alert("Failed to create sensor: ".concat(l.message));case 14:return e.p=14,w(!1),e.f(14);case 15:return e.a(2)}},e,null,[[3,5],[2,13,14,15]])}));return function(){return e.apply(this,arguments)}}(),T=function(){var e=W(L().m(function e(t){var n;return L().w(function(e){for(;;)switch(e.p=e.n){case 0:if(t&&t.path){e.n=1;break}return e.a(2);case 1:if(window.confirm('Are you sure you want to delete sensor "'.concat(t.name,'"?'))){e.n=2;break}return e.a(2);case 2:return e.p=2,e.n=3,p.A.delete("/node/".concat(t.path));case 3:u(null),j(),e.n=5;break;case 4:e.p=4,n=e.v,alert("Failed to delete sensor: ".concat(n.message));case 5:return e.a(2)}},e,null,[[2,4]])}));return function(t){return e.apply(this,arguments)}}();return r.createElement("div",{className:"timeseries-dashboard p-3"},r.createElement("div",{className:"mb-3"},r.createElement("div",{className:"d-flex justify-content-between align-items-center"},r.createElement("div",null,r.createElement("h4",null,r.createElement("i",{className:"fas fa-chart-line me-2"}),"Timeseries Dashboard"),r.createElement("small",{className:"text-muted"},t)))),S&&r.createElement("div",{className:"alert alert-danger alert-dismissible fade show",role:"alert"},r.createElement("i",{className:"fas fa-exclamation-triangle me-2"}),S,r.createElement("button",{type:"button",className:"btn-close",onClick:function(){return k(null)}})),g&&0===c.length?r.createElement("div",{className:"text-center py-5"},r.createElement("div",{className:"spinner-border text-primary",role:"status"},r.createElement("span",{className:"visually-hidden"},"Loading...")),r.createElement("p",{className:"mt-2"},"Loading sensors...")):0===c.length?r.createElement("div",{className:"alert alert-info"},r.createElement("i",{className:"fas fa-info-circle me-2"}),"No sensors found under this node.",r.createElement("button",{className:"btn btn-sm btn-primary ms-3",onClick:A},r.createElement("i",{className:"fas fa-plus me-1"}),"Create First Sensor")):r.createElement("div",{className:"row"},r.createElement("div",{className:"col-md-3"},r.createElement(o,{sensors:c,selectedSensor:i,onSelectSensor:u})),r.createElement("div",{className:"col-md-9"},r.createElement(N,{timeRange:f,interval:y,onTimeRangeChange:d,onIntervalChange:b,onRefresh:function(){j()},onCreateSensor:A}),i&&r.createElement(r.Fragment,null,r.createElement(E,{sensor:i,timeRange:f,interval:y}),r.createElement("div",{className:"row mt-3"},r.createElement("div",{className:"col-md-6"},r.createElement(x,{sensor:i,limit:10})),r.createElement("div",{className:"col-md-6"},r.createElement(D,{sensor:i,onSensorDeleted:function(){return T(i)},onRefresh:j})))))))}}}]);